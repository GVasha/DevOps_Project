{"ast":null,"code":"import axios from 'axios';\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\nconst FILE_BASE_URL = (process.env.REACT_APP_API_URL || 'http://localhost:5000').replace(/\\/$/, '');\n\n// Create axios instance with default config\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 30000,\n  // 30 seconds timeout\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Request interceptor to add auth token\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('authToken');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Response interceptor to handle errors globally\napi.interceptors.response.use(response => {\n  return response;\n}, error => {\n  var _error$response;\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n    // Token expired or invalid\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('user');\n    window.location.href = '/login';\n  }\n  return Promise.reject(error);\n});\n\n// Auth API calls\nexport const authAPI = {\n  register: userData => api.post('/auth/register', userData),\n  login: credentials => api.post('/auth/login', credentials),\n  getProfile: () => api.get('/auth/profile'),\n  updateProfile: userData => api.put('/auth/profile', userData),\n  deleteAccount: () => api.delete('/auth/account')\n};\n\n// Upload API calls\nexport const uploadAPI = {\n  uploadSingle: formData => {\n    return api.post('/upload/single', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n  },\n  uploadMultiple: formData => {\n    return api.post('/upload/multiple', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n  },\n  getFileInfo: filename => api.get(`/upload/file/${filename}`),\n  deleteFile: filename => api.delete(`/upload/file/${filename}`)\n};\n\n// Assessment API calls\nexport const assessmentAPI = {\n  analyzeImage: data => api.post('/assessment/analyze', data),\n  getMyAssessments: () => api.get('/assessment/my-assessments'),\n  getAssessment: id => api.get(`/assessment/assessment/${id}`),\n  createClaim: claimData => api.post('/assessment/create-claim', claimData),\n  getMyClaims: () => api.get('/assessment/my-claims'),\n  getClaim: id => api.get(`/assessment/claim/${id}`)\n};\n\n// Health check\nexport const healthCheck = () => api.get('/health');\n\n// Build absolute URL for files served from backend /uploads\nexport const getFileUrl = relativeOrAbsolute => {\n  if (!relativeOrAbsolute) return '';\n  const url = String(relativeOrAbsolute);\n\n  // If already absolute, return as-is\n  if (/^https?:\\/\\//i.test(url)) return url;\n\n  // If starts with /uploads, prefix with API host\n  if (url.startsWith('/uploads')) {\n    return `${FILE_BASE_URL}${url}`;\n  }\n\n  // If it's just a filename without path, assume /uploads\n  if (!url.includes('/') && /\\.(jpg|jpeg|png|gif|webp)$/i.test(url)) {\n    return `${FILE_BASE_URL}/uploads/${url}`;\n  }\n\n  // Otherwise return the URL as-is (might be relative)\n  return url;\n};\nexport default api;","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","FILE_BASE_URL","replace","api","create","baseURL","timeout","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","response","_error$response","status","removeItem","window","location","href","authAPI","register","userData","post","login","credentials","getProfile","get","updateProfile","put","deleteAccount","delete","uploadAPI","uploadSingle","formData","uploadMultiple","getFileInfo","filename","deleteFile","assessmentAPI","analyzeImage","data","getMyAssessments","getAssessment","id","createClaim","claimData","getMyClaims","getClaim","healthCheck","getFileUrl","relativeOrAbsolute","url","String","test","startsWith","includes"],"sources":["C:/Users/grego/Desktop/DevOps Insurance/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\nconst FILE_BASE_URL = (process.env.REACT_APP_API_URL || 'http://localhost:5000').replace(/\\/$/, '');\r\n\r\n// Create axios instance with default config\r\nconst api = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  timeout: 30000, // 30 seconds timeout\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Request interceptor to add auth token\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem('authToken');\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor to handle errors globally\r\napi.interceptors.response.use(\r\n  (response) => {\r\n    return response;\r\n  },\r\n  (error) => {\r\n    if (error.response?.status === 401) {\r\n      // Token expired or invalid\r\n      localStorage.removeItem('authToken');\r\n      localStorage.removeItem('user');\r\n      window.location.href = '/login';\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Auth API calls\r\nexport const authAPI = {\r\n  register: (userData) => api.post('/auth/register', userData),\r\n  login: (credentials) => api.post('/auth/login', credentials),\r\n  getProfile: () => api.get('/auth/profile'),\r\n  updateProfile: (userData) => api.put('/auth/profile', userData),\r\n  deleteAccount: () => api.delete('/auth/account'),\r\n};\r\n\r\n// Upload API calls\r\nexport const uploadAPI = {\r\n  uploadSingle: (formData) => {\r\n    return api.post('/upload/single', formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    });\r\n  },\r\n  uploadMultiple: (formData) => {\r\n    return api.post('/upload/multiple', formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    });\r\n  },\r\n  getFileInfo: (filename) => api.get(`/upload/file/${filename}`),\r\n  deleteFile: (filename) => api.delete(`/upload/file/${filename}`),\r\n};\r\n\r\n// Assessment API calls\r\nexport const assessmentAPI = {\r\n  analyzeImage: (data) => api.post('/assessment/analyze', data),\r\n  getMyAssessments: () => api.get('/assessment/my-assessments'),\r\n  getAssessment: (id) => api.get(`/assessment/assessment/${id}`),\r\n  createClaim: (claimData) => api.post('/assessment/create-claim', claimData),\r\n  getMyClaims: () => api.get('/assessment/my-claims'),\r\n  getClaim: (id) => api.get(`/assessment/claim/${id}`),\r\n};\r\n\r\n// Health check\r\nexport const healthCheck = () => api.get('/health');\r\n\r\n// Build absolute URL for files served from backend /uploads\r\nexport const getFileUrl = (relativeOrAbsolute) => {\r\n  if (!relativeOrAbsolute) return '';\r\n  \r\n  const url = String(relativeOrAbsolute);\r\n  \r\n  // If already absolute, return as-is\r\n  if (/^https?:\\/\\//i.test(url)) return url;\r\n  \r\n  // If starts with /uploads, prefix with API host\r\n  if (url.startsWith('/uploads')) {\r\n    return `${FILE_BASE_URL}${url}`;\r\n  }\r\n  \r\n  // If it's just a filename without path, assume /uploads\r\n  if (!url.includes('/') && /\\.(jpg|jpeg|png|gif|webp)$/i.test(url)) {\r\n    return `${FILE_BASE_URL}/uploads/${url}`;\r\n  }\r\n  \r\n  // Otherwise return the URL as-is (might be relative)\r\n  return url;\r\n};\r\n\r\nexport default api;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}